{"ast":null,"code":"var _jsxFileName = \"C:\\\\SravsGithub\\\\sravsrepo\\\\projections\\\\src\\\\Components\\\\Search.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport './Search.css';\nimport { If, Else, Elif } from 'rc-if-else';\nimport { Label, PrimaryButton, List } from 'office-ui-fabric-react';\nimport { SearchBox, ISearchBoxStyles } from 'office-ui-fabric-react/lib/SearchBox';\nimport { DetailsList, DetailsListLayoutMode, Selection, IColumn } from 'office-ui-fabric-react/lib/DetailsList';\n\nconst _MS_PER_DAY = 1000 * 60 * 60 * 24;\n\nfunction Search() {\n  _s();\n\n  const searchBoxStyles = {\n    root: {\n      width: 200\n    }\n  };\n  const [state, setState] = useState({\n    searchString: \"\",\n    projectID: \"\",\n    projectName: \"\",\n    description: \"\",\n    startDate: new Date(),\n    endDate: new Date(),\n    projDetailsVisible: false,\n    resources: [],\n    projNotFound: false,\n    shouldShowProjections: false,\n    totalBill: 0,\n    poStatus: \"active\",\n    poValue: \"\",\n    poNum: \"\",\n    origPoNum: \"\",\n    poType: \"sow\",\n    projType: \"t&m\",\n    salesSegment: \"\",\n    cluster: \"\",\n    clientPartner: \"\",\n    accountManager: \"\",\n    cdmName: \"\"\n  });\n\n  function onSubmit(searchString) {\n    //e.preventDefault();\n    console.log(searchString + \"------------\");\n    const url = \"https://projectionsazurefunctions.azurewebsites.net/api/Search?code=CbTDUtF5NSctIKh/jP6BmrifZ17wiSyQvqc0COv0G1ybdouglcICWw==&ProjectName=\" + searchString; //const url = \"http://localhost:7071/api/AddProject\";\n\n    fetch(url, {\n      method: \"GET\"\n    }).then(response => response.json()).then(project => {\n      if (project.projectID != null) {\n        setState(prevstate => {\n          return { ...prevstate,\n            projNotFound: false,\n            projDetailsVisible: true,\n            shouldShowProjections: false,\n            projectID: project.projectID,\n            projectName: project.projectName,\n            startDate: new Date(Date.parse(project.startDate)),\n            endDate: new Date(Date.parse(project.endDate)),\n            description: project.description,\n            resources: project.resources,\n            poStatus: project.poStatus == 0 ? \"Active\" : \"Inactive\",\n            poValue: project.poValue,\n            poType: project.poType == 0 ? \"SOW\" : \"Beeline\",\n            projType: project.projectType == 0 ? \"T&M\" : \"Fixed Price\",\n            poNum: project.poNumber,\n            origPoNum: project.OrginalPoNumber,\n            salesSegment: project.salesSegment,\n            cluster: project.cluster,\n            clientPartner: project.clientPartner,\n            accountManager: project.accountManager,\n            cdmName: project.cdmName\n          };\n        });\n      } else {\n        setState(prevstate => {\n          return { ...prevstate,\n            projNotFound: true,\n            projDetailsVisible: false,\n            shouldShowProjections: false\n          };\n        });\n      }\n    }).catch(err => {\n      alert(err);\n    });\n  }\n\n  function showProjections() {\n    var billing = 0;\n    state.resources.map(res => {\n      billing += res.billing;\n    });\n    var a = state.startDate;\n    var b = state.endDate;\n    const utc1 = Date.UTC(a.getFullYear(), a.getMonth(), a.getDate());\n    const utc2 = Date.UTC(b.getFullYear(), b.getMonth(), b.getDate());\n    var diffdays = Math.floor((utc2 - utc1) / _MS_PER_DAY);\n    billing *= diffdays;\n    setState(prevstate => {\n      return { ...prevstate,\n        totalBill: billing,\n        shouldShowProjections: true\n      };\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"SearchSection\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 17\n    }\n  }, \"Search for the Project ID\"), /*#__PURE__*/React.createElement(SearchBox, {\n    styles: searchBoxStyles,\n    placeholder: \"Enter the Project name\",\n    onSearch: onSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(If, {\n    condition: state.projNotFound,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 21\n    }\n  }, \" Project not found! \")), /*#__PURE__*/React.createElement(If, {\n    condition: state.projDetailsVisible,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    className: \"projdetailheader\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 17\n    }\n  }, \" Project Details \"), /*#__PURE__*/React.createElement(\"table\", {\n    className: \"projdetails\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"tbody\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    className: \"projfield\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 29\n    }\n  }, \"Project ID\")), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 29\n    }\n  }, state.projectID))), /*#__PURE__*/React.createElement(\"tr\", {\n    className: \"projfield\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 29\n    }\n  }, \"Project Name\")), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 29\n    }\n  }, state.projectName))), /*#__PURE__*/React.createElement(\"tr\", {\n    className: \"projfield\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 29\n    }\n  }, \"Description\")), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 29\n    }\n  }, state.description))), /*#__PURE__*/React.createElement(\"tr\", {\n    className: \"projfield\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 29\n    }\n  }, \"Start Date\")), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 29\n    }\n  }, state.startDate.toString()))), /*#__PURE__*/React.createElement(\"tr\", {\n    className: \"projfield\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 29\n    }\n  }, \"End Date\")), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 29\n    }\n  }, state.endDate.toString()))), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(If, {\n    condition: state.resources.length > 0,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 21\n    }\n  }, \" Resources \"), /*#__PURE__*/React.createElement(\"ul\", {\n    className: \"projfield\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 21\n    }\n  }, state.resources.map(res => /*#__PURE__*/React.createElement(\"li\", {\n    className: \"projfield\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 25\n    }\n  }, res.resourceName))), /*#__PURE__*/React.createElement(DetailsList, {\n    items: items,\n    columns: this._columns,\n    setKey: \"set\",\n    layoutMode: DetailsListLayoutMode.justified,\n    selection: this._selection,\n    selectionPreservedOnEmptyClick: true,\n    ariaLabelForSelectionColumn: \"Toggle selection\",\n    ariaLabelForSelectAllCheckbox: \"Toggle selection for all items\",\n    checkButtonAriaLabel: \"Row checkbox\",\n    onItemInvoked: this._onItemInvoked,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(If, {\n    condition: state.resources.length == 0,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 21\n    }\n  }, \" No resources assigned to the project as of now. \")))), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(If, {\n    condition: state.resources.length > 0,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(PrimaryButton, {\n    id: \"Projections\",\n    onClick: showProjections,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 18\n    }\n  }, \"Show Projection\")), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(If, {\n    condition: state.shouldShowProjections,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(\"table\", {\n    className: \"BillingTable\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"tbody\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 29\n    }\n  }, \" Resource Name\"), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 29\n    }\n  }, \" Bill (/day) \"), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 29\n    }\n  }, \" Bill for the project duration\")), state.resources.map(res => /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"td\", {\n    className: \"resentry\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 29\n    }\n  }, \" \", res.resourceName, \" \"), /*#__PURE__*/React.createElement(\"td\", {\n    className: \"resentry\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 29\n    }\n  }, \" $\", res.billing, \" \"), /*#__PURE__*/React.createElement(\"td\", {\n    className: \"resentry\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 29\n    }\n  }, \" $\", res.billing * ((state.endDate - state.startDate) / _MS_PER_DAY)))), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 29\n    }\n  }, \" Total\"), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 29\n    }\n  }, \"  - \"), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 29\n    }\n  }, \" $\", state.totalBill, \" \"))))));\n}\n\n_s(Search, \"jTMRR0r21cHhh8jUd/hzhcOxhOo=\");\n\n_c = Search;\nexport default Search;\n\nvar _c;\n\n$RefreshReg$(_c, \"Search\");","map":{"version":3,"sources":["C:/SravsGithub/sravsrepo/projections/src/Components/Search.js"],"names":["React","useState","If","Else","Elif","Label","PrimaryButton","List","SearchBox","ISearchBoxStyles","DetailsList","DetailsListLayoutMode","Selection","IColumn","_MS_PER_DAY","Search","searchBoxStyles","root","width","state","setState","searchString","projectID","projectName","description","startDate","Date","endDate","projDetailsVisible","resources","projNotFound","shouldShowProjections","totalBill","poStatus","poValue","poNum","origPoNum","poType","projType","salesSegment","cluster","clientPartner","accountManager","cdmName","onSubmit","console","log","url","fetch","method","then","response","json","project","prevstate","parse","projectType","poNumber","OrginalPoNumber","catch","err","alert","showProjections","billing","map","res","a","b","utc1","UTC","getFullYear","getMonth","getDate","utc2","diffdays","Math","floor","toString","length","resourceName","items","_columns","justified","_selection","_onItemInvoked"],"mappings":"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","sourcesContent":["import React, {useState} from 'react';\r\nimport './Search.css';\r\nimport { If, Else, Elif } from 'rc-if-else';\r\nimport { Label, PrimaryButton, List } from 'office-ui-fabric-react';\r\nimport { SearchBox, ISearchBoxStyles } from 'office-ui-fabric-react/lib/SearchBox';\r\nimport { DetailsList, DetailsListLayoutMode, Selection, IColumn } from 'office-ui-fabric-react/lib/DetailsList';\r\n\r\n\r\nconst _MS_PER_DAY = 1000 * 60 * 60 * 24;\r\nfunction Search(){\r\n\r\n    const searchBoxStyles = { root: { width: 200 } };\r\n    const [state, setState] = useState({\r\n        searchString: \"\",\r\n        projectID: \"\",\r\n        projectName : \"\",\r\n        description : \"\",\r\n        startDate : new Date(),\r\n        endDate : new Date(),\r\n        projDetailsVisible: false,\r\n        resources: [],\r\n        projNotFound: false,\r\n        shouldShowProjections: false,\r\n        totalBill: 0,\r\n        poStatus:\"active\",\r\n        poValue: \"\",\r\n        poNum: \"\",\r\n        origPoNum: \"\",\r\n        poType: \"sow\",\r\n        projType: \"t&m\",\r\n        salesSegment: \"\",\r\n        cluster: \"\",\r\n        clientPartner: \"\",\r\n        accountManager: \"\",\r\n        cdmName: \"\"\r\n      });\r\n\r\n    function onSubmit(searchString) {\r\n        //e.preventDefault();\r\n        console.log(searchString + \"------------\")\r\n        const url = \"https://projectionsazurefunctions.azurewebsites.net/api/Search?code=CbTDUtF5NSctIKh/jP6BmrifZ17wiSyQvqc0COv0G1ybdouglcICWw==&ProjectName=\"+searchString;\r\n        //const url = \"http://localhost:7071/api/AddProject\";\r\n        fetch(url, {\r\n              method : \"GET\",\r\n            }).then(response => response.json()\r\n            ).then(project => {\r\n                if(project.projectID != null)\r\n                {\r\n                setState(prevstate =>\r\n                    {return{...prevstate,\r\n                      projNotFound: false,\r\n                      projDetailsVisible: true,\r\n                      shouldShowProjections: false,\r\n                      projectID: project.projectID,\r\n                      projectName: project.projectName,\r\n                      startDate: new Date(Date.parse(project.startDate)),\r\n                      endDate: new Date(Date.parse(project.endDate)),\r\n                      description: project.description,\r\n                      resources: project.resources,\r\n                      poStatus: project.poStatus == 0 ? \"Active\" : \"Inactive\",\r\n                      poValue: project.poValue,\r\n                      poType: project.poType == 0 ? \"SOW\" : \"Beeline\",\r\n                      projType: project.projectType == 0 ? \"T&M\" : \"Fixed Price\",\r\n                      poNum: project.poNumber,\r\n                      origPoNum: project.OrginalPoNumber,\r\n                      salesSegment: project.salesSegment,\r\n                      cluster: project.cluster,\r\n                      clientPartner: project.clientPartner,\r\n                      accountManager: project.accountManager,\r\n                      cdmName: project.cdmName\r\n                    }\r\n                    }\r\n                );\r\n                }\r\n                else{\r\n                    setState(prevstate =>\r\n                        {return{...prevstate,\r\n                            projNotFound: true,\r\n                            projDetailsVisible: false,\r\n                            shouldShowProjections: false}\r\n                        })\r\n                }\r\n\r\n            }).catch(err => {alert(err)});\r\n      }\r\n      \r\n      function showProjections() {\r\n          var billing = 0\r\n        state.resources.map(res =>{\r\n            billing +=res.billing;   \r\n        } )   \r\n        var a = state.startDate;\r\n        var b = state.endDate;\r\n        const utc1 = Date.UTC(a.getFullYear(), a.getMonth(), a.getDate());\r\n        const utc2 = Date.UTC(b.getFullYear(), b.getMonth(), b.getDate());\r\n        var diffdays = Math.floor((utc2 - utc1) / _MS_PER_DAY);\r\n        billing *= diffdays  \r\n        setState(prevstate => {\r\n            return{...prevstate,totalBill : billing,\r\n                shouldShowProjections: true}\r\n            \r\n        })\r\n      }\r\n\r\n        return(\r\n            <div className=\"SearchSection\">\r\n                <Label>Search for the Project ID</Label>\r\n                <SearchBox\r\n                    styles={searchBoxStyles}\r\n                    placeholder=\"Enter the Project name\"\r\n                    onSearch={onSubmit}\r\n                />\r\n                <If condition={state.projNotFound}>\r\n                    <h3> Project not found! </h3>\r\n                </If>\r\n                <If condition={state.projDetailsVisible}>\r\n                <h2 className = \"projdetailheader\"> Project Details </h2>\r\n                <table className=\"projdetails\">\r\n                    <tbody>\r\n                    <tr className=\"projfield\"> \r\n                        <td><label >Project ID</label></td>\r\n                        <td><label>{state.projectID}</label></td>\r\n                    </tr>\r\n                    <tr className=\"projfield\">\r\n                        <td><label>Project Name</label></td>\r\n                        <td><label>{state.projectName}</label></td>\r\n                    </tr>\r\n                    <tr className=\"projfield\">\r\n                        <td><label>Description</label></td>\r\n                        <td><label>{state.description}</label></td>\r\n                    </tr>\r\n                    <tr className=\"projfield\">\r\n                        <td><label>Start Date</label></td>\r\n                        <td><label>{state.startDate.toString()}</label></td>\r\n                    </tr>\r\n                    <tr className=\"projfield\">\r\n                        <td><label>End Date</label></td>\r\n                        <td><label>{state.endDate.toString()}</label></td>\r\n                    </tr>\r\n                    <br/>\r\n                    <If condition={state.resources.length > 0}>\r\n                    <h3> Resources </h3>\r\n                    <ul className=\"projfield\">\r\n                    { state.resources.map(res =>\r\n                        <li className=\"projfield\">{res.resourceName}</li>)\r\n                    }\r\n                    </ul> \r\n                    <DetailsList\r\n            items={items}\r\n            columns={this._columns}\r\n            setKey=\"set\"\r\n            layoutMode={DetailsListLayoutMode.justified}\r\n            selection={this._selection}\r\n            selectionPreservedOnEmptyClick={true}\r\n            ariaLabelForSelectionColumn=\"Toggle selection\"\r\n            ariaLabelForSelectAllCheckbox=\"Toggle selection for all items\"\r\n            checkButtonAriaLabel=\"Row checkbox\"\r\n            onItemInvoked={this._onItemInvoked}\r\n          />\r\n                    </If>\r\n                    <If condition={state.resources.length == 0}>\r\n                    <h3> No resources assigned to the project as of now. </h3>\r\n                    </If>\r\n                    </tbody>\r\n                </table>\r\n                <br></br>\r\n                </If>\r\n                <If condition={state.resources.length > 0}>\r\n                 <PrimaryButton id=\"Projections\" onClick={showProjections}>Show Projection</PrimaryButton>\r\n                </If>\r\n                <br></br>\r\n                <If condition={state.shouldShowProjections} >\r\n                <br></br>\r\n                    <table className=\"BillingTable\">\r\n                        <tbody>\r\n                        <tr>\r\n                            <td> Resource Name</td>\r\n                            <td> Bill (/day) </td>\r\n                            <td> Bill for the project duration</td>\r\n                        </tr>\r\n                        { state.resources.map(res =>\r\n                        <tr>\r\n                            <td className=\"resentry\"> {res.resourceName} </td>\r\n                            <td className=\"resentry\"> ${res.billing} </td>\r\n                            <td className=\"resentry\"> ${res.billing * ((state.endDate - state.startDate)/_MS_PER_DAY)}</td>\r\n                        </tr>)}\r\n                        <br/>\r\n                        <tr>\r\n                            <td> Total</td>\r\n                            <td>  - </td>\r\n                            <td> ${state.totalBill} </td>\r\n                        </tr>\r\n                        </tbody>\r\n                    </table>\r\n                    \r\n                </If>\r\n            </div>\r\n        );\r\n}\r\n\r\nexport default Search;"]},"metadata":{},"sourceType":"module"}